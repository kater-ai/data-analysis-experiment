-- What are the sales territories which generate the most customers and revenue?

SELECT
  dst.SALESTERRITORYREGION,
  dst.SALESTERRITORYCOUNTRY,
  COUNT(DISTINCT fis.CUSTOMERKEY) AS TOTAL_CUSTOMERS,
  SUM(fis.SALESAMOUNT) AS TOTAL_REVENUE
FROM
  KATER.ADVENTUREWORKSDW.FACTINTERNETSALES fis
  JOIN KATER.ADVENTUREWORKSDW.DIMSALESTERRITORY dst ON fis.SALESTERRITORYKEY = dst.SALESTERRITORYKEY
GROUP BY
  dst.SALESTERRITORYREGION,
  dst.SALESTERRITORYCOUNTRY
ORDER BY
  TOTAL_REVENUE DESC,
  TOTAL_CUSTOMERS DESC;